<UserControl x:Class="ZapretDesktop.CustomPopup"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" 
             x:Name="Body"
             Background="{x:Null}">
    <Grid VerticalAlignment="Center"
          Width="{Binding ElementName=Body, Path=Width}"
          Margin="{Binding ElementName=Body, Path=Margin}">
        <Border Background="Red" CornerRadius="8" Margin="1">
            <Border.Effect>
                <DropShadowEffect Color="Black"
                                  BlurRadius="20"
                                  ShadowDepth="4"
                                  Direction="270"
                                  Opacity="0.8" />
            </Border.Effect>
        </Border>
        <Border x:Name="Bg"
                Background="{Binding ElementName=Body, Path=PopupBackground}"
                d:Background="Gray"
                CornerRadius="8" 
                BorderBrush="{DynamicResource WindowBorderColor}"
                BorderThickness="0.5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Border Background="{DynamicResource TitleBarColor}" 
                        VerticalAlignment="Top" CornerRadius="8,8,0,0">
                    <Grid>
                        <ContentPresenter Height="30" 
                                          Width="30"
                                          HorizontalAlignment="Left"
                                          Content="{Binding ElementName=Body, Path=Icon}"/>
                        <TextBlock VerticalAlignment="Center" 
                                   HorizontalAlignment="Left" 
                                   Margin="30,0,0,0" 
                                   Foreground="{DynamicResource MainTextColor}"
                                   Text="{Binding ElementName=Body, Path=Title}">
                        </TextBlock>
                        <Button HorizontalAlignment="Right" 
                                Width="46"
                                Click="ClosePopupButton_OnClick"
                                Visibility="{Binding ElementName=Body, Path=CloseButtonVisibility}"
                                Style="{StaticResource CloseWindowButtonStyle}" />
                    </Grid>
                </Border>
                <ContentPresenter Grid.Row="1"
                                  Content="{Binding ElementName=Body, Path=PopupContent}">
                </ContentPresenter>
                <ContentControl Grid.Row="2" 
                                Content="{Binding ElementName=Body, Path=ButtonStack}"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>

